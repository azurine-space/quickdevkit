<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSON í¬ë§·í„° & ê²€ì¦ ë„êµ¬</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/javascript/javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/edit/matchbrackets.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/edit/closebrackets.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/material-darker.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f9fafb;
            min-height: 100vh;
            transition: all 0.2s ease;
        }

        body.dark {
            background-color: #111827;
            color: #f9fafb;
        }

        .header-banner {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            padding: 1rem;
            text-align: center;
            font-size: 0.875rem;
        }

        .header {
            background: white;
            border-bottom: 1px solid #e5e7eb;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            transition: all 0.2s ease;
        }

        .dark .header {
            background: #1f2937;
            border-bottom: 1px solid #374151;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.5rem;
            font-weight: bold;
            color: #1f2937;
        }

        .dark .logo {
            color: #f9fafb;
        }

        .logo-icon {
            width: 2rem;
            height: 2rem;
            background: #3b82f6;
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .nav-tabs {
            display: flex;
            gap: 0.25rem;
            margin-left: 2rem;
        }

        .nav-tab {
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.2s ease;
            cursor: pointer;
            border: none;
            background: none;
        }

        .nav-tab.active {
            background: #dbeafe;
            color: #1d4ed8;
        }

        .dark .nav-tab.active {
            background: #1e3a8a;
            color: #93c5fd;
        }

        .nav-tab:not(.active) {
            color: #6b7280;
        }

        .nav-tab:not(.active):hover {
            color: #374151;
        }

        .dark .nav-tab:not(.active) {
            color: #9ca3af;
        }

        .dark .nav-tab:not(.active):hover {
            color: #d1d5db;
        }

        .theme-toggle {
            background: #f3f4f6;
            border: none;
            border-radius: 0.375rem;
            padding: 0.5rem;
            cursor: pointer;
            transition: all 0.2s ease;
            color: #6b7280;
        }

        .theme-toggle:hover {
            background: #e5e7eb;
            color: #374151;
        }

        .dark .theme-toggle {
            background: #374151;
            color: #9ca3af;
        }

        .dark .theme-toggle:hover {
            background: #4b5563;
            color: #d1d5db;
        }

        .language-select {
            background: #f3f4f6;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            padding: 0.5rem;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s ease;
            color: #374151;
        }

        .language-select:hover {
            background: #e5e7eb;
            border-color: #9ca3af;
        }

        .language-select:focus {
            outline: none;
            ring: 2px;
            ring-color: #3b82f6;
            border-color: #3b82f6;
        }

        .dark .language-select {
            background: #374151;
            border-color: #4b5563;
            color: #d1d5db;
        }

        .dark .language-select:hover {
            background: #4b5563;
            border-color: #6b7280;
        }

        .dark .language-select:focus {
            border-color: #3b82f6;
        }

        .main-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }

        .editor-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        @media (max-width: 768px) {
            .editor-container {
                grid-template-columns: 1fr;
            }
        }

        .editor-panel {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            overflow: hidden;
            transition: all 0.2s ease;
        }

        .dark .editor-panel {
            background: #1f2937;
            border: 1px solid #374151;
        }

        .panel-header {
            background: #f9fafb;
            border-bottom: 1px solid #e5e7eb;
            padding: 0.75rem 1rem;
            display: flex;
            justify-content: between;
            align-items: center;
            transition: all 0.2s ease;
        }

        .dark .panel-header {
            background: #374151;
            border-bottom: 1px solid #4b5563;
        }

        .panel-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: #1f2937;
            flex: 1;
        }

        .dark .panel-title {
            color: #f9fafb;
        }

        .panel-actions {
            display: flex;
            gap: 0.5rem;
        }

        .btn {
            background: #f3f4f6;
            border: none;
            border-radius: 0.375rem;
            padding: 0.375rem 0.75rem;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .btn:hover {
            background: #e5e7eb;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-primary {
            background: #3b82f6;
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: #2563eb;
        }

        .dark .btn {
            background: #4b5563;
            color: #d1d5db;
        }

        .dark .btn:hover {
            background: #6b7280;
        }

        .editor-wrapper {
            position: relative;
            height: 400px;
            border: 1px solid #e5e7eb;
            border-radius: 0 0 0.5rem 0.5rem;
            overflow: hidden;
        }

        .dark .editor-wrapper {
            border-color: #374151;
        }

        .CodeMirror {
            height: 400px !important;
            width: 100% !important;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 14px;
            line-height: 1.5;
            border-radius: 0 0 0.5rem 0.5rem;
        }

        .CodeMirror-scroll {
            max-height: 400px !important;
            overflow-y: auto !important;
            overflow-x: auto !important;
        }

        .error-line {
            background: rgba(248, 113, 113, 0.2) !important;
            border-left: 4px solid #ef4444 !important;
        }

        .error-line-gutter {
            background: rgba(248, 113, 113, 0.3) !important;
            color: #dc2626 !important;
            font-weight: bold !important;
        }

        .comment-notice {
            padding: 0.5rem 1rem;
            background: #f0f9ff;
            border-bottom: 1px solid #e5e7eb;
            font-size: 0.75rem;
            color: #0369a1;
            transition: all 0.2s ease;
        }

        .dark .comment-notice {
            background: #1e3a8a;
            border-bottom: 1px solid #374151;
            color: #93c5fd;
        }

        .status-panel {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            padding: 1rem;
            margin-bottom: 2rem;
            transition: all 0.2s ease;
        }

        .dark .status-panel {
            background: #1f2937;
            border: 1px solid #374151;
        }

        .status-success {
            border-color: #10b981;
            background: #ecfdf5;
        }

        .dark .status-success {
            background: #064e3b;
            border-color: #065f46;
        }

        .status-error {
            border-color: #ef4444;
            background: #fef2f2;
        }

        .dark .status-error {
            background: #7f1d1d;
            border-color: #991b1b;
        }

        .status-content {
            display: flex;
            align-items: start;
            gap: 0.75rem;
        }

        .status-icon {
            width: 1.25rem;
            height: 1.25rem;
            margin-top: 0.125rem;
        }

        .status-text {
            flex: 1;
        }

        .status-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .status-message {
            font-size: 0.875rem;
            opacity: 0.8;
        }

        .ad-panel {
            background: #f3f4f6;
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            padding: 1.5rem;
            text-align: center;
            margin-bottom: 2rem;
            transition: all 0.2s ease;
        }

        .dark .ad-panel {
            background: #1f2937;
            border: 1px solid #374151;
        }

        .footer {
            background: white;
            border-top: 1px solid #e5e7eb;
            padding: 1.5rem;
            text-align: center;
            margin-top: 3rem;
            transition: all 0.2s ease;
        }

        .dark .footer {
            background: #1f2937;
            border-top: 1px solid #374151;
        }

        .footer-text {
            color: #6b7280;
            font-size: 0.875rem;
            line-height: 1.5;
        }

        .dark .footer-text {
            color: #9ca3af;
        }

        .copied-badge {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background: #10b981;
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            font-weight: 500;
            transform: translateY(-100%);
            opacity: 0;
            transition: all 0.3s ease;
            pointer-events: none;
        }

        .copied-badge.show {
            transform: translateY(0);
            opacity: 1;
        }
    </style>
</head>
<body>
    <!-- Header Banner -->
    <div class="header-banner">
        <div data-i18n="headerBanner">ğŸ“¢ Ad Space - Welcome to Developer Tools Collection!</div>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div style="display: flex; align-items: center;">
                <div class="logo">
                    <div class="logo-icon">{}</div>
                    <span data-i18n="devTools">Dev Tools</span>
                </div>
                
                <nav class="nav-tabs">
                    <button class="nav-tab active" onclick="setActiveTab('json')" data-i18n="jsonTool">JSON Tool</button>
                    <button class="nav-tab" disabled data-i18n="markdownSoon">Markdown (Coming Soon)</button>
                    <button class="nav-tab" disabled data-i18n="base64Soon">Base64 (Coming Soon)</button>
                </nav>
            </div>

            <div style="display: flex; align-items: center; gap: 1rem;">
                <button class="theme-toggle" onclick="toggleTheme()" title="í…Œë§ˆ ë³€ê²½">
                    <span id="theme-icon">ğŸŒ™</span>
                </button>
                
                <select class="language-select" id="language-select" onchange="changeLanguage(this.value)">
                    <option value="en">English</option>
                    <option value="ko">í•œêµ­ì–´</option>
                    <option value="ja">æ—¥æœ¬èª</option>
                    <option value="zh-CN">ä¸­æ–‡</option>
                </select>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <div class="editor-container">
            <!-- Input Panel -->
            <div class="editor-panel">
                <div class="panel-header">
                    <h2 class="panel-title" data-i18n="jsonInput">JSON Input</h2>
                    <div class="panel-actions">
                        <button class="btn" onclick="loadSample()" data-i18n="loadSample">Load Sample</button>
                        <button class="btn" onclick="clearInput()" data-i18n="clear">Clear</button>
                    </div>
                </div>
                <div class="comment-notice" data-i18n="commentNotice">
                    ğŸ’¡ Comments supported: // single line comments and /* multi-line comments */
                </div>
                <div class="editor-wrapper">
                    <div id="input-editor"></div>
                </div>
            </div>

            <!-- Output Panel -->
            <div class="editor-panel">
                <div class="panel-header">
                    <h2 class="panel-title" data-i18n="formattedJson">Formatted JSON</h2>
                    <div class="panel-actions">
                        <button class="btn" onclick="minifyJson()" id="minify-btn" disabled data-i18n="minify">Minify</button>
                        <button class="btn btn-primary" onclick="copyOutput()" id="copy-btn" disabled>
                            <span id="copy-icon">ğŸ“‹</span>
                            <span id="copy-text" data-i18n="copy">Copy</span>
                        </button>
                    </div>
                </div>
                <div class="editor-wrapper" style="position: relative;">
                    <div id="output-editor"></div>
                    <div class="copied-badge" id="copied-badge" data-i18n="copied">Copied!</div>
                </div>
            </div>
        </div>

        <!-- Status Panel -->
        <div class="status-panel" id="status-panel" style="display: none;">
            <div class="status-content">
                <div class="status-icon" id="status-icon"></div>
                <div class="status-text">
                    <div class="status-title" id="status-title"></div>
                    <div class="status-message" id="status-message"></div>
                </div>
            </div>
        </div>

        <!-- Ad Panel -->
        <div class="ad-panel">
            <div style="font-size: 0.875rem; color: #6b7280; margin-bottom: 0.5rem;" data-i18n="adTitle">ğŸ“± Sidebar Ad Space</div>
            <div style="font-size: 0.75rem; color: #9ca3af;" data-i18n="adText">
                More developer tools coming soon!<br>
                HTML formatter, Unicode converter, URL encoder, etc.
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-text">
            <p data-i18n="footerText1">Â© 2025 Dev Tools. Useful tool collection for developers</p>
            <p style="margin-top: 0.25rem;" data-i18n="footerText2">JSON formatter, validator and more tools</p>
        </div>
    </footer>

    <script>
        // Global variables
        let inputEditor, outputEditor;
        let isDarkMode = false;
        let errorLineWidget = null;
        let currentLanguage = 'en'; // Default to English

        // Language translations
        const translations = {
            ko: {
                // Header
                headerBanner: 'ğŸ“¢ ê´‘ê³  ì˜ì—­ - ê°œë°œì ë„êµ¬ ëª¨ìŒì§‘ì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤!',
                devTools: 'Dev Tools',
                jsonTool: 'JSON ë„êµ¬',
                markdownSoon: 'ë§ˆí¬ë‹¤ìš´ (ê³§ ì¶œì‹œ)',
                base64Soon: 'Base64 (ê³§ ì¶œì‹œ)',
                
                // Panel headers
                jsonInput: 'JSON ì…ë ¥',
                formattedJson: 'í¬ë§·ëœ JSON',
                
                // Buttons
                loadSample: 'ìƒ˜í”Œ ë¡œë“œ',
                clear: 'ì§€ìš°ê¸°',
                minify: 'ì••ì¶•',
                copy: 'ë³µì‚¬',
                copied: 'ë³µì‚¬ë¨!',
                
                // Messages
                commentNotice: 'ğŸ’¡ ì£¼ì„ ì§€ì›: // ë‹¨ì¼ ë¼ì¸ ì£¼ì„ê³¼ /* ë©€í‹° ë¼ì¸ ì£¼ì„ */ ì‚¬ìš© ê°€ëŠ¥',
                validJson: 'ìœ íš¨í•œ JSONì…ë‹ˆë‹¤!',
                successFormat: 'ì„±ê³µì ìœ¼ë¡œ í¬ë§·ë˜ì—ˆìŠµë‹ˆë‹¤. (ì£¼ì„ì€ ì¶œë ¥ì—ì„œ ì œê±°ë©ë‹ˆë‹¤)',
                syntaxError: 'JSON ë¬¸ë²• ì˜¤ë¥˜',
                minifyFailed: 'ì••ì¶• ì‹¤íŒ¨',
                invalidJson: 'ìœ íš¨í•˜ì§€ ì•Šì€ JSONì…ë‹ˆë‹¤.',
                copyFailed: 'ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.',
                
                // Placeholders
                inputPlaceholder: 'JSONì„ ì…ë ¥í•˜ì„¸ìš”...',
                outputPlaceholder: 'í¬ë§·ëœ JSONì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...',
                
                // Footer
                footerText1: 'Â© 2025 Dev Tools. ê°œë°œìë¥¼ ìœ„í•œ ìœ ìš©í•œ ë„êµ¬ ëª¨ìŒì§‘',
                footerText2: 'JSON í¬ë§·í„°, ê²€ì¦ê¸° ë° ë” ë§ì€ ë„êµ¬ë“¤',
                
                // Ad
                adTitle: 'ğŸ“± ì‚¬ì´ë“œë°” ê´‘ê³  ì˜ì—­',
                adText: 'ì¶”ê°€ ê°œë°œì ë„êµ¬ë“¤ì´ ê³§ ì¶œì‹œë©ë‹ˆë‹¤!<br>HTML í¬ë§·í„°, ìœ ë‹ˆì½”ë“œ ë³€í™˜ê¸°, URL ì¸ì½”ë” ë“±'
            },
            
            en: {
                // Header
                headerBanner: 'ğŸ“¢ Ad Space - Welcome to Developer Tools Collection!',
                devTools: 'Dev Tools',
                jsonTool: 'JSON Tool',
                markdownSoon: 'Markdown (Coming Soon)',
                base64Soon: 'Base64 (Coming Soon)',
                
                // Panel headers
                jsonInput: 'JSON Input',
                formattedJson: 'Formatted JSON',
                
                // Buttons
                loadSample: 'Load Sample',
                clear: 'Clear',
                minify: 'Minify',
                copy: 'Copy',
                copied: 'Copied!',
                
                // Messages
                commentNotice: 'ğŸ’¡ Comments supported: // single line comments and /* multi-line comments */',
                validJson: 'Valid JSON!',
                successFormat: 'Successfully formatted. (Comments are removed from output)',
                syntaxError: 'JSON Syntax Error',
                minifyFailed: 'Minify Failed',
                invalidJson: 'Invalid JSON.',
                copyFailed: 'Failed to copy.',
                
                // Placeholders
                inputPlaceholder: 'Enter JSON here...',
                outputPlaceholder: 'Formatted JSON will be displayed here...',
                
                // Footer
                footerText1: 'Â© 2025 Dev Tools. Useful tool collection for developers',
                footerText2: 'JSON formatter, validator and more tools',
                
                // Ad
                adTitle: 'ğŸ“± Sidebar Ad Space',
                adText: 'More developer tools coming soon!<br>HTML formatter, Unicode converter, URL encoder, etc.'
            },
            
            ja: {
                // Header
                headerBanner: 'ğŸ“¢ åºƒå‘Šã‚¨ãƒªã‚¢ - é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã¸ã‚ˆã†ã“ãï¼',
                devTools: 'Dev Tools',
                jsonTool: 'JSONãƒ„ãƒ¼ãƒ«',
                markdownSoon: 'Markdownï¼ˆè¿‘æ—¥å…¬é–‹ï¼‰',
                base64Soon: 'Base64ï¼ˆè¿‘æ—¥å…¬é–‹ï¼‰',
                
                // Panel headers
                jsonInput: 'JSONå…¥åŠ›',
                formattedJson: 'ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆæ¸ˆã¿JSON',
                
                // Buttons
                loadSample: 'ã‚µãƒ³ãƒ—ãƒ«èª­ã¿è¾¼ã¿',
                clear: 'ã‚¯ãƒªã‚¢',
                minify: 'åœ§ç¸®',
                copy: 'ã‚³ãƒ”ãƒ¼',
                copied: 'ã‚³ãƒ”ãƒ¼å®Œäº†ï¼',
                
                // Messages
                commentNotice: 'ğŸ’¡ ã‚³ãƒ¡ãƒ³ãƒˆå¯¾å¿œ: // å˜è¡Œã‚³ãƒ¡ãƒ³ãƒˆ ã¨ /* è¤‡æ•°è¡Œã‚³ãƒ¡ãƒ³ãƒˆ */',
                validJson: 'æœ‰åŠ¹ãªJSONã§ã™ï¼',
                successFormat: 'æ­£å¸¸ã«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã•ã‚Œã¾ã—ãŸã€‚ï¼ˆã‚³ãƒ¡ãƒ³ãƒˆã¯å‡ºåŠ›ã‹ã‚‰å‰Šé™¤ã•ã‚Œã¾ã™ï¼‰',
                syntaxError: 'JSONæ§‹æ–‡ã‚¨ãƒ©ãƒ¼',
                minifyFailed: 'åœ§ç¸®å¤±æ•—',
                invalidJson: 'ç„¡åŠ¹ãªJSONã§ã™ã€‚',
                copyFailed: 'ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸã€‚',
                
                // Placeholders
                inputPlaceholder: 'JSONã‚’å…¥åŠ›ã—ã¦ãã ã•ã„...',
                outputPlaceholder: 'ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆæ¸ˆã¿JSONãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™...',
                
                // Footer
                footerText1: 'Â© 2025 Dev Tools. é–‹ç™ºè€…ã®ãŸã‚ã®ä¾¿åˆ©ãªãƒ„ãƒ¼ãƒ«é›†',
                footerText2: 'JSONãƒ•ã‚©ãƒ¼ãƒãƒƒã‚¿ãƒ¼ã€ãƒãƒªãƒ‡ãƒ¼ã‚¿ãƒ¼ã€ãã®ä»–ã®ãƒ„ãƒ¼ãƒ«',
                
                // Ad
                adTitle: 'ğŸ“± ã‚µã‚¤ãƒ‰ãƒãƒ¼åºƒå‘Šã‚¨ãƒªã‚¢',
                adText: 'è¿½åŠ ã®é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ãŒè¿‘æ—¥å…¬é–‹ï¼<br>HTMLãƒ•ã‚©ãƒ¼ãƒãƒƒã‚¿ãƒ¼ã€Unicodeå¤‰æ›å™¨ã€URLã‚¨ãƒ³ã‚³ãƒ¼ãƒ€ãƒ¼ãªã©'
            },
            
            'zh-CN': {
                // Header
                headerBanner: 'ğŸ“¢ å¹¿å‘ŠåŒºåŸŸ - æ¬¢è¿ä½¿ç”¨å¼€å‘è€…å·¥å…·é›†ï¼',
                devTools: 'Dev Tools',
                jsonTool: 'JSONå·¥å…·',
                markdownSoon: 'Markdownï¼ˆå³å°†æ¨å‡ºï¼‰',
                base64Soon: 'Base64ï¼ˆå³å°†æ¨å‡ºï¼‰',
                
                // Panel headers
                jsonInput: 'JSONè¾“å…¥',
                formattedJson: 'æ ¼å¼åŒ–JSON',
                
                // Buttons
                loadSample: 'åŠ è½½ç¤ºä¾‹',
                clear: 'æ¸…ç©º',
                minify: 'å‹ç¼©',
                copy: 'å¤åˆ¶',
                copied: 'å·²å¤åˆ¶ï¼',
                
                // Messages
                commentNotice: 'ğŸ’¡ æ”¯æŒæ³¨é‡Šï¼š// å•è¡Œæ³¨é‡Š å’Œ /* å¤šè¡Œæ³¨é‡Š */',
                validJson: 'æœ‰æ•ˆçš„JSONï¼',
                successFormat: 'æ ¼å¼åŒ–æˆåŠŸã€‚ï¼ˆæ³¨é‡Šå·²ä»è¾“å‡ºä¸­ç§»é™¤ï¼‰',
                syntaxError: 'JSONè¯­æ³•é”™è¯¯',
                minifyFailed: 'å‹ç¼©å¤±è´¥',
                invalidJson: 'æ— æ•ˆçš„JSONã€‚',
                copyFailed: 'å¤åˆ¶å¤±è´¥ã€‚',
                
                // Placeholders
                inputPlaceholder: 'è¯·è¾“å…¥JSON...',
                outputPlaceholder: 'æ ¼å¼åŒ–çš„JSONå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...',
                
                // Footer
                footerText1: 'Â© 2025 Dev Tools. å¼€å‘è€…å®ç”¨å·¥å…·é›†',
                footerText2: 'JSONæ ¼å¼åŒ–å™¨ã€éªŒè¯å™¨åŠæ›´å¤šå·¥å…·',
                
                // Ad
                adTitle: 'ğŸ“± ä¾§è¾¹æ å¹¿å‘ŠåŒºåŸŸ',
                adText: 'æ›´å¤šå¼€å‘è€…å·¥å…·å³å°†æ¨å‡ºï¼<br>HTMLæ ¼å¼åŒ–å™¨ã€Unicodeè½¬æ¢å™¨ã€URLç¼–ç å™¨ç­‰'
            }
        };

        // Get translation text
        function t(key) {
            return translations[currentLanguage][key] || translations['en'][key] || key;
        }

        // Detect browser language
        function detectBrowserLanguage() {
            // Get browser languages in order of preference
            const browserLanguages = [];
            
            // Add navigator.language
            if (navigator.language) {
                browserLanguages.push(navigator.language);
            }
            
            // Add navigator.languages array
            if (navigator.languages && navigator.languages.length > 0) {
                browserLanguages.push(...navigator.languages);
            }
            
            // Add locale from Intl
            try {
                const locale = Intl.DateTimeFormat().resolvedOptions().locale;
                if (locale) {
                    browserLanguages.push(locale);
                }
            } catch (e) {
                // Intl might not be available
            }
            
            // Add language based on timezone/region detection
            const regionLang = detectLanguageFromRegion();
            if (regionLang) {
                browserLanguages.push(regionLang);
            }
            
            // Supported languages
            const supportedLanguages = Object.keys(translations);
            
            // Try to match languages
            for (const browserLang of browserLanguages) {
                const lang = browserLang.toLowerCase();
                
                // Exact match (e.g., 'ko' -> 'ko')
                if (supportedLanguages.includes(lang)) {
                    return lang;
                }
                
                // Language code match (e.g., 'ko-KR' -> 'ko')
                const langCode = lang.split('-')[0];
                if (supportedLanguages.includes(langCode)) {
                    return langCode;
                }
                
                // Special case for Chinese
                if (lang.includes('zh')) {
                    if (lang.includes('cn') || lang.includes('hans') || lang.includes('sg')) {
                        return 'zh-CN'; // Simplified Chinese
                    }
                    // Default to Simplified Chinese for other Chinese variants
                    return 'zh-CN';
                }
            }
            
            // Default to English if no match found
            return 'en';
        }

        // Detect language from region/timezone
        function detectLanguageFromRegion() {
            try {
                // Get timezone
                const timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
                
                // Timezone to language mapping
                const timezoneToLanguage = {
                    // Korea
                    'Asia/Seoul': 'ko',
                    
                    // Japan
                    'Asia/Tokyo': 'ja',
                    
                    // China
                    'Asia/Shanghai': 'zh-CN',
                    'Asia/Beijing': 'zh-CN',
                    'Asia/Chongqing': 'zh-CN',
                    'Asia/Harbin': 'zh-CN',
                    'Asia/Kashgar': 'zh-CN',
                    'Asia/Urumqi': 'zh-CN',
                    
                    // Taiwan/Hong Kong (using simplified for now)
                    'Asia/Taipei': 'zh-CN',
                    'Asia/Hong_Kong': 'zh-CN',
                    'Asia/Macau': 'zh-CN',
                    
                    // English speaking countries/regions
                    'America/New_York': 'en',
                    'America/Los_Angeles': 'en',
                    'America/Chicago': 'en',
                    'America/Denver': 'en',
                    'America/Phoenix': 'en',
                    'America/Anchorage': 'en',
                    'Pacific/Honolulu': 'en',
                    'Europe/London': 'en',
                    'Australia/Sydney': 'en',
                    'Australia/Melbourne': 'en',
                    'Australia/Perth': 'en',
                    'Pacific/Auckland': 'en',
                    'America/Toronto': 'en',
                    'America/Vancouver': 'en'
                };
                
                if (timezone && timezoneToLanguage[timezone]) {
                    return timezoneToLanguage[timezone];
                }
                
                // Fallback: analyze timezone string
                if (timezone) {
                    const tz = timezone.toLowerCase();
                    
                    if (tz.includes('asia/seoul')) return 'ko';
                    if (tz.includes('asia/tokyo')) return 'ja';
                    if (tz.includes('asia/shanghai') || tz.includes('asia/beijing')) return 'zh-CN';
                    if (tz.includes('america/') || tz.includes('europe/london') || 
                        tz.includes('australia/') || tz.includes('pacific/auckland')) return 'en';
                }
                
                return null;
            } catch (e) {
                // Could not detect timezone
                return null;
            }
        }

        // Detect language from HTTP headers (using additional methods)
        function detectLanguageFromHeaders() {
            // We can't access HTTP headers directly in browser JavaScript,
            // but we can use other browser APIs that might give us similar info
            
            const detectedLanguages = [];
            
            try {
                // Check if there's any Accept-Language-like info we can infer
                // from various browser APIs
                
                // Currency/number formatting can give us region hints
                const numberFormat = new Intl.NumberFormat();
                const currency = numberFormat.resolvedOptions().currency;
                
                const currencyToLanguage = {
                    'KRW': 'ko',  // Korean Won
                    'JPY': 'ja',  // Japanese Yen
                    'CNY': 'zh-CN', // Chinese Yuan
                    'USD': 'en',  // US Dollar
                    'GBP': 'en',  // British Pound
                    'CAD': 'en',  // Canadian Dollar
                    'AUD': 'en',  // Australian Dollar
                    'NZD': 'en'   // New Zealand Dollar
                };
                
                if (currency && currencyToLanguage[currency]) {
                    detectedLanguages.push(currencyToLanguage[currency]);
                }
                
                // Date formatting patterns can also give hints
                const dateFormat = new Intl.DateTimeFormat();
                const formatOptions = dateFormat.resolvedOptions();
                
                if (formatOptions.calendar === 'japanese') {
                    detectedLanguages.push('ja');
                }
                
                // Check number formatting style
                const testNumber = (12345.67).toLocaleString();
                if (testNumber.includes('ï¼Œ')) { // Chinese comma
                    detectedLanguages.push('zh-CN');
                } else if (testNumber.includes('12,345')) { // English-style formatting
                    detectedLanguages.push('en');
                }
                
            } catch (e) {
                // Could not detect language from formatting
            }
            
            return detectedLanguages;
        }

        // Update UI text based on current language
        function updateUI() {
            document.querySelectorAll('[data-i18n]').forEach(element => {
                const key = element.getAttribute('data-i18n');
                const translation = t(key);
                
                if (element.innerHTML.includes('<br>')) {
                    element.innerHTML = translation;
                } else {
                    element.textContent = translation;
                }
            });

            // Update placeholders
            if (inputEditor) {
                inputEditor.setOption('placeholder', t('inputPlaceholder'));
            }
            if (outputEditor) {
                outputEditor.setOption('placeholder', t('outputPlaceholder'));
            }
        }

        // Change language
        function changeLanguage(lang) {
            currentLanguage = lang;
            updateUI();
            
            // Save language preference (with error handling)
            try {
                localStorage.setItem('preferredLanguage', lang);
            } catch (e) {
                // Could not save language preference
            }
        }

        // Load language preference
        function loadLanguagePreference() {
            try {
                const saved = localStorage.getItem('preferredLanguage');
                if (saved && translations[saved]) {
                    currentLanguage = saved;
                } else {
                    // No saved preference, detect browser language
                    currentLanguage = detectBrowserLanguage();
                }
                document.getElementById('language-select').value = currentLanguage;
            } catch (e) {
                // Could not load language preference, detecting browser language
                currentLanguage = detectBrowserLanguage();
                document.getElementById('language-select').value = currentLanguage;
            }
        }

        // Initialize CodeMirror editors
        function initializeEditors() {
            // Input editor
            inputEditor = CodeMirror(document.getElementById('input-editor'), {
                mode: { name: "javascript", json: true },
                lineNumbers: true,
                matchBrackets: true,
                autoCloseBrackets: true,
                indentUnit: 2,
                tabSize: 2,
                lineWrapping: true,
                viewportMargin: 10,
                scrollbarStyle: "native",
                placeholder: t('inputPlaceholder'),
                theme: 'default'
            });

            // Output editor (read-only)
            outputEditor = CodeMirror(document.getElementById('output-editor'), {
                mode: { name: "javascript", json: true },
                lineNumbers: true,
                matchBrackets: true,
                indentUnit: 2,
                tabSize: 2,
                lineWrapping: true,
                viewportMargin: 10,
                scrollbarStyle: "native",
                readOnly: true,
                placeholder: t('outputPlaceholder'),
                theme: 'default'
            });

            // Input change handler
            inputEditor.on('change', function() {
                processJson();
            });

            // Refresh editors to ensure proper rendering
            setTimeout(() => {
                if (inputEditor && outputEditor) {
                    inputEditor.refresh();
                    outputEditor.refresh();
                    
                    // ìœˆë„ìš° ë¦¬ì‚¬ì´ì¦ˆ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
                    window.addEventListener('resize', function() {
                        setTimeout(() => {
                            inputEditor.refresh();
                            outputEditor.refresh();
                        }, 100);
                    });
                }
            }, 200);

            // Apply initial theme
            applyEditorTheme();
        }

        // Remove comments from JSON string (JSON5 style)
        function removeJsonComments(jsonString) {
            let result = '';
            let inString = false;
            let inSingleComment = false;
            let inMultiComment = false;
            let stringChar = '';
            let escaped = false;
            
            for (let i = 0; i < jsonString.length; i++) {
                const char = jsonString[i];
                const nextChar = jsonString[i + 1] || '';
                
                // Handle escaped characters
                if (escaped) {
                    if (inString) result += char;
                    escaped = false;
                    continue;
                }
                
                // Handle escape sequences in strings
                if (char === '\\' && inString) {
                    escaped = true;
                    result += char;
                    continue;
                }
                
                // Start of string
                if (!inSingleComment && !inMultiComment && !inString && (char === '"' || char === "'")) {
                    inString = true;
                    stringChar = char;
                    result += char;
                    continue;
                }
                
                // End of string
                if (inString && char === stringChar && !escaped) {
                    inString = false;
                    stringChar = '';
                    result += char;
                    continue;
                }
                
                // Skip comment detection inside strings
                if (inString) {
                    result += char;
                    continue;
                }
                
                // Start of single line comment
                if (!inMultiComment && char === '/' && nextChar === '/') {
                    inSingleComment = true;
                    i++; // skip next char
                    continue;
                }
                
                // Start of multi line comment
                if (!inSingleComment && char === '/' && nextChar === '*') {
                    inMultiComment = true;
                    i++; // skip next char
                    continue;
                }
                
                // End of single line comment
                if (inSingleComment && (char === '\n' || char === '\r')) {
                    inSingleComment = false;
                    result += char; // preserve line breaks
                    continue;
                }
                
                // End of multi line comment
                if (inMultiComment && char === '*' && nextChar === '/') {
                    inMultiComment = false;
                    i++; // skip next char
                    continue;
                }
                
                // Add character if not in comment
                if (!inSingleComment && !inMultiComment) {
                    result += char;
                }
            }
            
            return result;
        }

        // Process JSON input
        function processJson() {
            const input = inputEditor.getValue().trim();
            
            // Clear previous error highlights
            clearErrorHighlight();
            
            if (!input) {
                outputEditor.setValue('');
                hideStatus();
                updateButtonStates(false);
                return;
            }

            try {
                // Remove comments before parsing
                const cleanJson = removeJsonComments(input);
                const parsed = JSON.parse(cleanJson);
                const formatted = JSON.stringify(parsed, null, 2);
                outputEditor.setValue(formatted);
                showStatus('success', t('validJson'), t('successFormat'));
                updateButtonStates(true);
            } catch (error) {
                outputEditor.setValue('');
                showStatus('error', t('syntaxError'), error.message);
                updateButtonStates(false);
                
                // Highlight error line
                highlightErrorLine(input, error.message);
            }
        }

        // Clear error highlight
        function clearErrorHighlight() {
            if (inputEditor) {
                inputEditor.eachLine(function(line) {
                    inputEditor.removeLineClass(line, 'background', 'error-line');
                    inputEditor.removeLineClass(line, 'gutter', 'error-line-gutter');
                });
            }
        }

        // Highlight error line
        function highlightErrorLine(input, errorMessage) {
            const match = errorMessage.match(/at position (\d+)/);
            if (match) {
                const position = parseInt(match[1]);
                const beforeError = input.substring(0, position);
                const lineNumber = beforeError.split('\n').length - 1;
                
                if (lineNumber >= 0 && lineNumber < inputEditor.lineCount()) {
                    inputEditor.addLineClass(lineNumber, 'background', 'error-line');
                    inputEditor.addLineClass(lineNumber, 'gutter', 'error-line-gutter');
                }
            }
        }

        // Show status message
        function showStatus(type, title, message) {
            const panel = document.getElementById('status-panel');
            const icon = document.getElementById('status-icon');
            const titleEl = document.getElementById('status-title');
            const messageEl = document.getElementById('status-message');

            panel.className = `status-panel status-${type}`;
            panel.style.display = 'block';
            
            icon.innerHTML = type === 'success' ? 'âœ…' : 'âŒ';
            titleEl.textContent = title;
            messageEl.textContent = message;
        }

        // Hide status panel
        function hideStatus() {
            document.getElementById('status-panel').style.display = 'none';
        }

        // Update button states
        function updateButtonStates(hasValidOutput) {
            document.getElementById('minify-btn').disabled = !hasValidOutput;
            document.getElementById('copy-btn').disabled = !hasValidOutput;
        }

        // Copy output to clipboard
        async function copyOutput() {
            const output = outputEditor.getValue();
            if (!output) return;

            try {
                await navigator.clipboard.writeText(output);
                
                // Show copied badge
                const badge = document.getElementById('copied-badge');
                badge.classList.add('show');
                
                // Update button text
                document.getElementById('copy-icon').textContent = 'âœ…';
                document.getElementById('copy-text').textContent = t('copied');
                
                // Reset after 2 seconds
                setTimeout(() => {
                    badge.classList.remove('show');
                    document.getElementById('copy-icon').textContent = 'ğŸ“‹';
                    document.getElementById('copy-text').textContent = t('copy');
                }, 2000);
                
            } catch (err) {
                alert(t('copyFailed'));
            }
        }

        // Minify JSON
        function minifyJson() {
            const output = outputEditor.getValue();
            if (!output) return;

            try {
                // Output is already clean JSON (comments removed), so parse directly
                const parsed = JSON.parse(output);
                const minified = JSON.stringify(parsed);
                outputEditor.setValue(minified);
            } catch (err) {
                showStatus('error', t('minifyFailed'), t('invalidJson'));
            }
        }

        // Load sample JSON
        function loadSample() {
            clearErrorHighlight();
            
            const samples = {
                ko: `{
  // ì‚¬ìš©ì ê¸°ë³¸ ì •ë³´
  "name": "í™ê¸¸ë™",
  "age": 30,
  
  /* ì£¼ì†Œ ì •ë³´ - ë‹¤ì¤‘ ë¼ì¸ ì£¼ì„
     ì—¬ëŸ¬ ì¤„ì— ê±¸ì¹œ ì„¤ëª…ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤ */
  "address": {
    "city": "ì„œìš¸", // ë„ì‹œëª…
    "district": "ê°•ë‚¨êµ¬" // êµ¬/êµ° ì •ë³´
  },
  
  // ì·¨ë¯¸ ëª©ë¡ (ë°°ì—´)
  "hobbies": [
    "ë…ì„œ",      // ì±… ì½ê¸°
    "ì˜í™”ê°ìƒ",   // ì˜í™” ë³´ê¸°  
    "ì½”ë”©"       // í”„ë¡œê·¸ë˜ë°
  ],
  
  "active": true, // í™œì„± ìƒíƒœ
  
  // ë©”íƒ€ë°ì´í„°
  "metadata": {
    "createdAt": "2025-07-15T12:00:00Z",    // ìƒì„±ì¼ì‹œ
    "lastModified": "2025-07-15T12:30:00Z"  // ìµœì¢… ìˆ˜ì •ì¼ì‹œ
  }
}`,
                en: `{
  // User basic information
  "name": "John Doe",
  "age": 30,
  
  /* Address information - Multi-line comment
     Multi-line descriptions are possible */
  "address": {
    "city": "New York", // City name
    "district": "Manhattan" // District information
  },
  
  // Hobbies list (array)
  "hobbies": [
    "reading",     // Reading books
    "movies",      // Watching movies
    "coding"       // Programming
  ],
  
  "active": true, // Active status
  
  // Metadata
  "metadata": {
    "createdAt": "2025-07-15T12:00:00Z",    // Created datetime
    "lastModified": "2025-07-15T12:30:00Z"  // Last modified datetime
  }
}`,
                ja: `{
  // ãƒ¦ãƒ¼ã‚¶ãƒ¼åŸºæœ¬æƒ…å ±
  "name": "ç”°ä¸­å¤ªéƒ",
  "age": 30,
  
  /* ä½æ‰€æƒ…å ± - è¤‡æ•°è¡Œã‚³ãƒ¡ãƒ³ãƒˆ
     è¤‡æ•°è¡Œã«ã‚ãŸã‚‹èª¬æ˜ãŒå¯èƒ½ã§ã™ */
  "address": {
    "city": "æ±äº¬", // éƒ½å¸‚å
    "district": "æ¸‹è°·åŒº" // åŒº/éƒ¡æƒ…å ±
  },
  
  // è¶£å‘³ãƒªã‚¹ãƒˆï¼ˆé…åˆ—ï¼‰
  "hobbies": [
    "èª­æ›¸",        // æœ¬ã‚’èª­ã‚€
    "æ˜ ç”»é‘‘è³",    // æ˜ ç”»ã‚’è¦‹ã‚‹
    "ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°"  // ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°
  ],
  
  "active": true, // ã‚¢ã‚¯ãƒ†ã‚£ãƒ–çŠ¶æ…‹
  
  // ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿
  "metadata": {
    "createdAt": "2025-07-15T12:00:00Z",    // ä½œæˆæ—¥æ™‚
    "lastModified": "2025-07-15T12:30:00Z"  // æœ€çµ‚æ›´æ–°æ—¥æ™‚
  }
}`,
                'zh-CN': `{
  // ç”¨æˆ·åŸºæœ¬ä¿¡æ¯
  "name": "å¼ ä¸‰",
  "age": 30,
  
  /* åœ°å€ä¿¡æ¯ - å¤šè¡Œæ³¨é‡Š
     å¯ä»¥è¿›è¡Œå¤šè¡Œæè¿° */
  "address": {
    "city": "åŒ—äº¬", // åŸå¸‚å
    "district": "æœé˜³åŒº" // åŒº/å¿ä¿¡æ¯
  },
  
  // çˆ±å¥½åˆ—è¡¨ï¼ˆæ•°ç»„ï¼‰
  "hobbies": [
    "é˜…è¯»",     // è¯»ä¹¦
    "çœ‹ç”µå½±",   // çœ‹ç”µå½±
    "ç¼–ç¨‹"      // ç¼–ç¨‹
  ],
  
  "active": true, // æ´»è·ƒçŠ¶æ€
  
  // å…ƒæ•°æ®
  "metadata": {
    "createdAt": "2025-07-15T12:00:00Z",    // åˆ›å»ºæ—¶é—´
    "lastModified": "2025-07-15T12:30:00Z"  // æœ€åä¿®æ”¹æ—¶é—´
  }
}`
            };
            
            const sample = samples[currentLanguage] || samples['en'];
            inputEditor.setValue(sample);
            inputEditor.focus();
        }

        // Clear input
        function clearInput() {
            clearErrorHighlight();
            inputEditor.setValue('');
            inputEditor.focus();
        }

        // Toggle theme
        function toggleTheme() {
            isDarkMode = !isDarkMode;
            document.body.classList.toggle('dark', isDarkMode);
            document.getElementById('theme-icon').textContent = isDarkMode ? 'â˜€ï¸' : 'ğŸŒ™';
            applyEditorTheme();
        }

        // Apply editor theme
        function applyEditorTheme() {
            const theme = isDarkMode ? 'material-darker' : 'default';
            
            if (inputEditor) {
                inputEditor.setOption('theme', theme);
                inputEditor.refresh();
            }
            if (outputEditor) {
                outputEditor.setOption('theme', theme);
                outputEditor.refresh();
            }
        }

        // Set active tab (for future expansion)
        function setActiveTab(tab) {
            // Currently only JSON tab is active
            console.log('Active tab:', tab);
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            // Check if CodeMirror is loaded
            if (typeof CodeMirror === 'undefined') {
                alert('Error loading code editor. Please refresh the page.');
                return;
            }
            
            // Load language preference
            loadLanguagePreference();
            
            // Initialize editors
            initializeEditors();
            
            // Update UI with current language
            updateUI();
            
            // Auto-focus input editor
            setTimeout(() => {
                if (inputEditor) {
                    inputEditor.focus();
                }
            }, 100);
        });
    </script>
</body>
</html>
