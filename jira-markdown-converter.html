<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="QuickDevKit - Jiraì™€ Markdown ê°„ ì–‘ë°©í–¥ ë³€í™˜ê¸°. ë¹ ë¥´ê³  ì •í™•í•œ ë¬¸ë²• ë³€í™˜ ë„êµ¬">
    <meta name="keywords" content="jira converter, markdown converter, jira to markdown, markdown to jira, developer tools, quickdevkit">
    <meta name="google-adsense-account" content="ca-pub-2369255699430177">
    <title>QuickDevKit - Jira â†” Markdown Converter</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/markdown/markdown.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/edit/matchbrackets.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/edit/closebrackets.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/material-darker.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f9fafb;
            min-height: 100vh;
            transition: all 0.2s ease;
        }

        body.dark {
            background-color: #111827;
            color: #f9fafb;
        }

        .header {
            background: white;
            border-bottom: 1px solid #e5e7eb;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            transition: all 0.2s ease;
        }

        .dark .header {
            background: #1f2937;
            border-bottom: 1px solid #374151;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.5rem;
            font-weight: bold;
            color: #1f2937;
        }

        .dark .logo {
            color: #f9fafb;
        }

        .logo-icon {
            width: 2rem;
            height: 2rem;
            background: #3b82f6;
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .nav-tabs {
            display: flex;
            gap: 0.25rem;
            margin-left: 2rem;
        }

        .nav-tab {
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.2s ease;
            cursor: pointer;
            border: none;
            background: none;
            text-decoration: none;
        }

        .nav-tab.active {
            background: #dbeafe;
            color: #1d4ed8;
        }

        .dark .nav-tab.active {
            background: #1e3a8a;
            color: #93c5fd;
        }

        .nav-tab:not(.active) {
            color: #6b7280;
        }

        .nav-tab:not(.active):hover {
            color: #374151;
        }

        .dark .nav-tab:not(.active) {
            color: #9ca3af;
        }

        .dark .nav-tab:not(.active):hover {
            color: #d1d5db;
        }

        .theme-toggle {
            background: #f3f4f6;
            border: none;
            border-radius: 0.375rem;
            padding: 0.5rem;
            cursor: pointer;
            transition: all 0.2s ease;
            color: #6b7280;
        }

        .theme-toggle:hover {
            background: #e5e7eb;
            color: #374151;
        }

        .dark .theme-toggle {
            background: #374151;
            color: #9ca3af;
        }

        .dark .theme-toggle:hover {
            background: #4b5563;
            color: #d1d5db;
        }

        .main-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }

        .converter-container {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 1.5rem;
            align-items: start;
            margin-bottom: 2rem;
        }

        @media (max-width: 768px) {
            .converter-container {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            
            .converter-controls {
                order: -1;
            }
        }

        .editor-panel {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            overflow: hidden;
            transition: all 0.2s ease;
        }

        .dark .editor-panel {
            background: #1f2937;
            border: 1px solid #374151;
        }

        .panel-header {
            background: #f9fafb;
            border-bottom: 1px solid #e5e7eb;
            padding: 0.75rem 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s ease;
        }

        .dark .panel-header {
            background: #374151;
            border-bottom: 1px solid #4b5563;
        }

        .panel-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: #1f2937;
            flex: 1;
        }

        .dark .panel-title {
            color: #f9fafb;
        }

        .panel-actions {
            display: flex;
            gap: 0.5rem;
        }

        .btn {
            background: #f3f4f6;
            border: none;
            border-radius: 0.375rem;
            padding: 0.375rem 0.75rem;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .btn:hover {
            background: #e5e7eb;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-primary {
            background: #3b82f6;
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: #2563eb;
        }

        .dark .btn {
            background: #4b5563;
            color: #d1d5db;
        }

        .dark .btn:hover {
            background: #6b7280;
        }

        .editor-wrapper {
            position: relative;
            height: 400px;
            border-radius: 0 0 0.5rem 0.5rem;
            overflow: hidden;
        }

        .CodeMirror {
            height: 400px !important;
            width: 100% !important;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 14px;
            line-height: 1.5;
            border-radius: 0 0 0.5rem 0.5rem;
        }

        .CodeMirror-scroll {
            max-height: 400px !important;
            overflow-y: auto !important;
            overflow-x: auto !important;
        }

        .converter-controls {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            align-items: center;
            justify-content: center;
            padding: 2rem 0;
        }

        .convert-btn {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            border: none;
            border-radius: 0.5rem;
            padding: 0.75rem 1.5rem;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 0 4px 6px rgba(59, 130, 246, 0.25);
        }

        .convert-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 15px rgba(59, 130, 246, 0.35);
        }

        .convert-btn:active {
            transform: translateY(0);
        }

        .arrow-icon {
            font-size: 1.25rem;
            transition: transform 0.3s ease;
        }

        .convert-btn:hover .arrow-icon {
            transform: translateX(3px);
        }

        .status-panel {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            padding: 1rem;
            margin-bottom: 2rem;
            transition: all 0.2s ease;
        }

        .dark .status-panel {
            background: #1f2937;
            border: 1px solid #374151;
        }

        .status-success {
            border-color: #10b981;
            background: #ecfdf5;
        }

        .dark .status-success {
            background: #064e3b;
            border-color: #065f46;
        }

        .status-error {
            border-color: #ef4444;
            background: #fef2f2;
        }

        .dark .status-error {
            background: #7f1d1d;
            border-color: #991b1b;
        }

        .status-content {
            display: flex;
            align-items: start;
            gap: 0.75rem;
        }

        .status-icon {
            width: 1.25rem;
            height: 1.25rem;
            margin-top: 0.125rem;
        }

        .status-text {
            flex: 1;
        }

        .status-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .status-message {
            font-size: 0.875rem;
            opacity: 0.8;
        }

        .copied-badge {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background: #10b981;
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            font-weight: 500;
            transform: translateY(-100%);
            opacity: 0;
            transition: all 0.3s ease;
            pointer-events: none;
        }

        .copied-badge.show {
            transform: translateY(0);
            opacity: 1;
        }

        .footer {
            background: white;
            border-top: 1px solid #e5e7eb;
            padding: 1.5rem;
            text-align: center;
            margin-top: 3rem;
            transition: all 0.2s ease;
        }

        .dark .footer {
            background: #1f2937;
            border-top: 1px solid #374151;
        }

        .footer-text {
            color: #6b7280;
            font-size: 0.875rem;
            line-height: 1.5;
        }

        .dark .footer-text {
            color: #9ca3af;
        }

        .guide-section {
            margin: 3rem 0;
            padding: 2rem 0;
        }

        .section-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .section-title {
            font-size: 2rem;
            font-weight: bold;
            color: #1f2937;
            margin-bottom: 0.5rem;
        }

        .dark .section-title {
            color: #f9fafb;
        }

        .section-subtitle {
            color: #6b7280;
            font-size: 1.125rem;
        }

        .dark .section-subtitle {
            color: #9ca3af;
        }

        .guide-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .guide-card {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 0.75rem;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .guide-card:hover {
            border-color: #3b82f6;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);
            transform: translateY(-2px);
        }

        .dark .guide-card {
            background: #1f2937;
            border-color: #374151;
        }

        .dark .guide-card:hover {
            border-color: #3b82f6;
        }

        .guide-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }

        .guide-card-header h3 {
            font-size: 1.25rem;
            font-weight: 600;
            color: #1f2937;
            margin: 0;
        }

        .dark .guide-card-header h3 {
            color: #f9fafb;
        }

        .expand-icon {
            color: #6b7280;
            font-size: 0.875rem;
            transition: transform 0.3s ease;
        }

        .guide-card.expanded .expand-icon {
            transform: rotate(180deg);
        }

        .guide-card-desc {
            color: #6b7280;
            font-size: 0.875rem;
            line-height: 1.5;
            margin: 0;
        }

        .dark .guide-card-desc {
            color: #9ca3af;
        }

        .guide-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            margin-top: 1rem;
        }

        .guide-content.show {
            max-height: 1000px;
        }

        .content-example {
            margin-bottom: 1.5rem;
        }

        .content-example h4 {
            color: #374151;
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .dark .content-example h4 {
            color: #d1d5db;
        }

        .content-example pre {
            background: #f3f4f6;
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            padding: 1rem;
            overflow-x: auto;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 0.875rem;
            line-height: 1.5;
        }

        .dark .content-example pre {
            background: #374151;
            border-color: #4b5563;
            color: #f9fafb;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div style="display: flex; align-items: center;">
                <div class="logo">
                    <div class="logo-icon">âš¡</div>
                    <span>QuickDevKit</span>
                </div>
                
                <nav class="nav-tabs">
                    <a href="index.html" class="nav-tab">JSON Tool</a>
                    <a href="svg-converter.html" class="nav-tab">SVG Converter</a>
                    <button class="nav-tab active">Jira â†” Markdown</button>
                    <button class="nav-tab" disabled>Base64 (Coming Soon)</button>
                </nav>
            </div>

            <div style="display: flex; align-items: center; gap: 1rem;">
                <button class="theme-toggle" onclick="toggleTheme()" title="í…Œë§ˆ ë³€ê²½">
                    <span id="theme-icon">ğŸŒ™</span>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <div class="converter-container">
            <!-- Jira Input Panel -->
            <div class="editor-panel">
                <div class="panel-header">
                    <h2 class="panel-title">Jira ë¬¸ë²•</h2>
                    <div class="panel-actions">
                        <button class="btn" onclick="loadJiraSample()">ìƒ˜í”Œ ë¡œë“œ</button>
                        <button class="btn" onclick="clearJiraInput()">ì§€ìš°ê¸°</button>
                        <button class="btn btn-primary" onclick="copyJiraInput()">
                            <span>ğŸ“‹</span>
                            <span>ë³µì‚¬</span>
                        </button>
                    </div>
                </div>
                <div class="editor-wrapper" style="position: relative;">
                    <div id="jira-editor"></div>
                    <div class="copied-badge" id="jira-copied-badge">ë³µì‚¬ë¨!</div>
                </div>
            </div>

            <!-- Converter Controls -->
            <div class="converter-controls">
                <button class="convert-btn" onclick="convertJiraToMarkdown()">
                    <span>Jira â†’ MD</span>
                    <span class="arrow-icon">â†’</span>
                </button>
                <button class="convert-btn" onclick="convertMarkdownToJira()">
                    <span class="arrow-icon">â†</span>
                    <span>MD â†’ Jira</span>
                </button>
            </div>

            <!-- Markdown Output Panel -->
            <div class="editor-panel">
                <div class="panel-header">
                    <h2 class="panel-title">Markdown ë¬¸ë²•</h2>
                    <div class="panel-actions">
                        <button class="btn" onclick="loadMarkdownSample()">ìƒ˜í”Œ ë¡œë“œ</button>
                        <button class="btn" onclick="clearMarkdownInput()">ì§€ìš°ê¸°</button>
                        <button class="btn btn-primary" onclick="copyMarkdownInput()">
                            <span>ğŸ“‹</span>
                            <span>ë³µì‚¬</span>
                        </button>
                    </div>
                </div>
                <div class="editor-wrapper" style="position: relative;">
                    <div id="markdown-editor"></div>
                    <div class="copied-badge" id="markdown-copied-badge">ë³µì‚¬ë¨!</div>
                </div>
            </div>
        </div>

        <!-- Status Panel -->
        <div class="status-panel" id="status-panel" style="display: none;">
            <div class="status-content">
                <div class="status-icon" id="status-icon"></div>
                <div class="status-text">
                    <div class="status-title" id="status-title"></div>
                    <div class="status-message" id="status-message"></div>
                </div>
            </div>
        </div>

        <!-- Guide Section -->
        <section class="guide-section">
            <div class="section-header">
                <h2 class="section-title">Jira â†” Markdown ë³€í™˜ ê°€ì´ë“œ</h2>
                <p class="section-subtitle">ì–‘ë°©í–¥ ë¬¸ë²• ë³€í™˜ìœ¼ë¡œ ë” íš¨ìœ¨ì ì¸ ë¬¸ì„œ ì‘ì—…ì„ ì‹œì‘í•˜ì„¸ìš”</p>
            </div>
            
            <div class="guide-grid">
                <div class="guide-card" onclick="toggleGuideContent('jira-syntax')">
                    <div class="guide-card-header">
                        <h3>Jira ë¬¸ë²• ê°€ì´ë“œ</h3>
                        <span class="expand-icon">â–¼</span>
                    </div>
                    <p class="guide-card-desc">Jiraì—ì„œ ì‚¬ìš©í•˜ëŠ” ë‹¤ì–‘í•œ í…ìŠ¤íŠ¸ í¬ë§·íŒ… ë¬¸ë²•ì„ ì•Œì•„ë³´ì„¸ìš”</p>
                    <div class="guide-content" id="jira-syntax-content">
                        <div class="content-example">
                            <h4>ê¸°ë³¸ í…ìŠ¤íŠ¸ í¬ë§·íŒ…:</h4>
                            <pre><code>*êµµì€ ê¸€ì”¨*
_ê¸°ìš¸ì„ ê¸€ì”¨_
-ì·¨ì†Œì„ -
{{ë‹¨ìˆœ í…ìŠ¤íŠ¸}}
{code:java}
ì½”ë“œ ë¸”ë¡
{code}</code></pre>
                        </div>
                        <div class="content-example">
                            <h4>ëª©ë¡ê³¼ ì¸ìš©:</h4>
                            <pre><code>* ë¶ˆë¦¿ ëª©ë¡
# ë²ˆí˜¸ ëª©ë¡
bq. ì¸ìš©ë¬¸</code></pre>
                        </div>
                    </div>
                </div>

                <div class="guide-card" onclick="toggleGuideContent('markdown-syntax')">
                    <div class="guide-card-header">
                        <h3>Markdown ë¬¸ë²• ê°€ì´ë“œ</h3>
                        <span class="expand-icon">â–¼</span>
                    </div>
                    <p class="guide-card-desc">GitHub, Notion ë“±ì—ì„œ ì‚¬ìš©í•˜ëŠ” í‘œì¤€ Markdown ë¬¸ë²• ì •ë¦¬</p>
                    <div class="guide-content" id="markdown-syntax-content">
                        <div class="content-example">
                            <h4>ê¸°ë³¸ í…ìŠ¤íŠ¸ í¬ë§·íŒ…:</h4>
                            <pre><code>**êµµì€ ê¸€ì”¨**
*ê¸°ìš¸ì„ ê¸€ì”¨*
~~ì·¨ì†Œì„ ~~
`ì¸ë¼ì¸ ì½”ë“œ`
```java
ì½”ë“œ ë¸”ë¡
```</code></pre>
                        </div>
                        <div class="content-example">
                            <h4>ëª©ë¡ê³¼ ì¸ìš©:</h4>
                            <pre><code>- ë¶ˆë¦¿ ëª©ë¡
1. ë²ˆí˜¸ ëª©ë¡
> ì¸ìš©ë¬¸</code></pre>
                        </div>
                    </div>
                </div>

                <div class="guide-card" onclick="toggleGuideContent('conversion-tips')">
                    <div class="guide-card-header">
                        <h3>ë³€í™˜ íŒ</h3>
                        <span class="expand-icon">â–¼</span>
                    </div>
                    <p class="guide-card-desc">íš¨ìœ¨ì ì¸ ë³€í™˜ì„ ìœ„í•œ ìœ ìš©í•œ íŒê³¼ ì£¼ì˜ì‚¬í•­</p>
                    <div class="guide-content" id="conversion-tips-content">
                        <div class="content-example">
                            <h4>ë³€í™˜ ì‹œ ì£¼ì˜ì‚¬í•­:</h4>
                            <ul style="padding-left: 1.5rem; color: #4b5563;">
                                <li>ì´ë¯¸ì§€ëŠ” ì²¨ë¶€íŒŒì¼ ì •ë³´ê°€ í•„ìš”í•©ë‹ˆë‹¤</li>
                                <li>í…Œì´ë¸” êµ¬ì¡°ëŠ” ì •í™•íˆ ë§ì¶°ì•¼ í•©ë‹ˆë‹¤</li>
                                <li>ì¤‘ì²©ëœ ëª©ë¡ì˜ ë“¤ì—¬ì“°ê¸°ì— ì£¼ì˜í•˜ì„¸ìš”</li>
                                <li>ë§í¬ í˜•ì‹ì€ ìë™ìœ¼ë¡œ ë³€í™˜ë©ë‹ˆë‹¤</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-text">
            <p>Â© 2025 QuickDevKit. Jiraì™€ Markdown ê°„ ì–‘ë°©í–¥ ë³€í™˜ ë„êµ¬</p>
            <p style="margin-top: 0.25rem;">ë¹ ë¥´ê³  ì •í™•í•œ ë¬¸ë²• ë³€í™˜ìœ¼ë¡œ ë¬¸ì„œ ì‘ì—…ì„ íš¨ìœ¨í™”í•˜ì„¸ìš”</p>
        </div>
    </footer>

    <script>
        // Global variables
        let jiraEditor, markdownEditor;
        let isDarkMode = false;

        // Jira to Markdown conversion function (from provided Python code)
        function jiraToMarkdown(text, attachments = []) {
            // ì½”ë“œ ë¸”ë¡ì„ ë¨¼ì € ì¶”ì¶œí•˜ì—¬ ë³´ê´€
            const codeBlocks = [];

            function extractCodeBlocks(match) {
                const lang = match[2] || '';
                const code = match[3];
                const placeholder = `@@CODE@@BLOCK@@${codeBlocks.length}@@`;
                codeBlocks.push(`\`\`\`${lang}\n${code}\n\`\`\``);
                return placeholder;
            }

            // ì½”ë“œ ë¸”ë¡ì„ ì¶”ì¶œí•˜ê³  í”Œë ˆì´ìŠ¤í™€ë”ë¡œ ëŒ€ì²´
            text = text.replace(/\{code(:([a-z]+))?\}(.*?)\{code\}/gs, extractCodeBlocks);

            // ë§í¬ íŒ¨í„´ ì¶”ì¶œí•˜ì—¬ ë³´ê´€
            const links = [];

            function extractLinks(match) {
                const linkText = match[1];
                const linkUrl = match[2];
                const placeholder = `@@LINK@@${links.length}@@`;
                links.push(`[${linkText}](${linkUrl})`);
                return placeholder;
            }

            // ë§í¬ë¥¼ ì¶”ì¶œí•˜ê³  í”Œë ˆì´ìŠ¤í™€ë”ë¡œ ëŒ€ì²´ (ë” ì •í™•í•œ íŒ¨í„´ ì‚¬ìš©)
            text = text.replace(/\[([^\|\]]+)\|([^\]]+)\]/g, extractLinks);

            // ì´ë¯¸ì§€ íŒ¨í„´ ì¶”ì¶œí•˜ì—¬ ë³´ê´€
            const images = [];

            function extractImages(match) {
                // íŒŒì¼ëª…ê³¼ ì§€ì‹œì ë¶€ë¶„ ë¶„ë¦¬ (ì˜ˆ: 'ëª¨ë‹ˆí„°ë§-8.png|thumbnail')
                const filenameWithDirectives = match[1];

                // '|' ë’¤ì˜ ì§€ì‹œìê°€ ìˆìœ¼ë©´ ì œê±°
                const filename = filenameWithDirectives.split('|')[0].trim();

                // attachments ë°°ì—´ì—ì„œ ì¼ì¹˜í•˜ëŠ” íŒŒì¼ëª… ì°¾ê¸°
                let imageUrl = null;
                for (const attachment of attachments) {
                    if (attachment.filename === filename) {
                        imageUrl = attachment.content;
                        break;
                    }
                }

                // ì´ë¯¸ì§€ URLì„ ì°¾ì§€ ëª»í•œ ê²½ìš° ì›ë˜ íŒŒì¼ëª…ì„ URLë¡œ ì‚¬ìš©
                if (!imageUrl) {
                    imageUrl = filename;
                }

                const placeholder = `@@IMAGE@@${images.length}@@`;
                // alt í…ìŠ¤íŠ¸ë¡œ íŒŒì¼ëª… ì‚¬ìš©
                images.push(`![${filename}](${imageUrl})`);
                return placeholder;
            }

            // ì´ë¯¸ì§€ë¥¼ ì¶”ì¶œí•˜ê³  í”Œë ˆì´ìŠ¤í™€ë”ë¡œ ëŒ€ì²´ (ë” ì •í™•í•œ íŒ¨í„´ ì‚¬ìš©)
            text = text.replace(/!([^!]+)!/g, extractImages);

            function jiraListToMarkdown(text) {
                const lines = text.split('\n');
                const markdownLines = [];

                for (const line of lines) {
                    const strippedLine = line.trim();
                    if (strippedLine.startsWith('*') || strippedLine.startsWith('#')) {
                        // ì²« ë²ˆì§¸ ê³µë°±ê¹Œì§€ì˜ ë¬¸ìì—´ ì¶”ì¶œ
                        const prefixMatch = strippedLine.match(/^[*#]+/);
                        if (prefixMatch) {
                            const prefix = prefixMatch[0];

                            // indent_level ê³„ì‚° (*ì™€ #ì˜ í•©)
                            const indentLevel = prefix.length;

                            // ë§ˆì§€ë§‰ ë¬¸ìë¡œ bulleted/numbered ê²°ì •
                            const isBulleted = prefix[prefix.length - 1] === '*';

                            const content = strippedLine.substring(prefix.length).trim();

                            let markdownLine;
                            if (isBulleted) {
                                markdownLine = '  '.repeat(indentLevel - 1) + '- ' + content;
                            } else { // numbered
                                markdownLine = '  '.repeat(indentLevel - 1) + '1. ' + content;
                            }

                            markdownLines.push(markdownLine);
                        } else {
                            markdownLines.push(line);
                        }
                    } else {
                        // ë¦¬ìŠ¤íŠ¸ê°€ ì•„ë‹Œ ì¤„ì€ ê·¸ëŒ€ë¡œ ìœ ì§€
                        markdownLines.push(line);
                    }
                }

                return markdownLines.join('\n');
            }

            // ë³€í™˜ ë¡œì§ ì ìš©
            text = text.replace(/-(.+?)-/g, '~~$1~~');
            text = jiraListToMarkdown(text);
            text = text.replace(/\*(.+?)\*/g, '**$1**');
            text = text.replace(/_(.+?)_/g, '*$1*');
            text = text.replace(/^bq\.\s(.+)/gm, '> $1');
            text = text.replace(/\{\{(.+?)\}\}/g, '`$1`');
            text = text.replace(/^h1\.\s(.+)/gm, '# $1');
            text = text.replace(/^h2\.\s(.+)/gm, '## $1');
            text = text.replace(/^h3\.\s(.+)/gm, '### $1');
            text = text.replace(/^h4\.\s(.+)/gm, '#### $1');
            text = text.replace(/^h5\.\s(.+)/gm, '##### $1');
            text = text.replace(/^h6\.\s(.+)/gm, '###### $1');

            // {quote} ë§¤í¬ë¡œ ë³€í™˜
            function quoteReplace(match) {
                const quotedText = match[1].trim();
                const lines = quotedText.split('\n');
                const quotedLines = lines.map(line => `> ${line}`);
                return quotedLines.join('\n');
            }
            text = text.replace(/\{quote\}(.*?)\{quote\}/gs, quoteReplace);

            // í…Œì´ë¸” ë³€í™˜
            function tableReplace(match) {
                const rows = match[0].trim().split('\n');
                const markdownTable = [];
                for (let i = 0; i < rows.length; i++) {
                    const row = rows[i];
                    if (row.startsWith('||')) { // í—¤ë” í–‰
                        const cells = row.replace(/^\|\||\|\|$/g, '').split('||').map(cell => cell.trim());
                        const markdownRow = `| ${cells.join(' | ')} |`;
                        markdownTable.push(markdownRow);
                        const separator = `|${cells.map(() => '---').join('|')}|`;
                        markdownTable.push(separator);
                    } else if (row.startsWith('|')) { // ë°ì´í„° í–‰
                        const cells = row.replace(/^\||\|$/g, '').split('|').map(cell => cell.trim());
                        const markdownRow = `| ${cells.join(' | ')} |`;
                        markdownTable.push(markdownRow);
                    }
                }
                return markdownTable.join('\n');
            }

            text = text.replace(/(\|\|.+?\|\|[\s\S]*?)(?=\n\n|$)/gm, tableReplace);

            // ë§í¬ ë‹¤ì‹œ ì‚½ì…
            for (let i = 0; i < links.length; i++) {
                text = text.replace(`@@LINK@@${i}@@`, links[i]);
            }

            // ì´ë¯¸ì§€ ë‹¤ì‹œ ì‚½ì…
            for (let i = 0; i < images.length; i++) {
                text = text.replace(`@@IMAGE@@${i}@@`, images[i]);
            }

            // ì½”ë“œ ë¸”ë¡ ë‹¤ì‹œ ì‚½ì…
            for (let i = 0; i < codeBlocks.length; i++) {
                text = text.replace(`@@CODE@@BLOCK@@${i}@@`, codeBlocks[i]);
            }

            return text;
        }

        // Markdown to Jira conversion function
        function markdownToJira(text) {
            // 1. ì½”ë“œ ë¸”ë¡ì„ ë¨¼ì € ì¶”ì¶œí•˜ì—¬ ë³´ê´€
            const codeBlocks = [];
            text = text.replace(/```(\w+)?\n([\s\S]*?)\n```/g, function(match, lang, code) {
                const placeholder = `@@CODE@@BLOCK@@${codeBlocks.length}@@`;
                codeBlocks.push(`{code${lang ? ':' + lang : ''}}\n${code}\n{code}`);
                return placeholder;
            });

            // 2. ì¸ë¼ì¸ ì½”ë“œ ì¶”ì¶œí•˜ì—¬ ë³´ê´€
            const inlineCodes = [];
            text = text.replace(/`([^`]+)`/g, function(match, code) {
                const placeholder = `@@INLINE@@CODE@@${inlineCodes.length}@@`;
                inlineCodes.push(`{{${code}}}`);
                return placeholder;
            });

            // 3. ë§í¬ íŒ¨í„´ ì¶”ì¶œí•˜ì—¬ ë³´ê´€
            const links = [];
            text = text.replace(/\[([^\]]+)\]\(([^\)]+)\)/g, function(match, linkText, linkUrl) {
                const placeholder = `@@LINK@@${links.length}@@`;
                links.push(`[${linkText}|${linkUrl}]`);
                return placeholder;
            });

            // 4. ì´ë¯¸ì§€ íŒ¨í„´ ì¶”ì¶œí•˜ì—¬ ë³´ê´€
            const images = [];
            text = text.replace(/!\[([^\]]*)\]\(([^\)]+)\)/g, function(match, altText, imageUrl) {
                const placeholder = `@@IMAGE@@${images.length}@@`;
                const filename = imageUrl.split('/').pop() || altText || 'image';
                images.push(`!${filename}!`);
                return placeholder;
            });

            // 5. ëª©ë¡ ë³€í™˜
            function markdownListToJira(text) {
                const lines = text.split('\n');
                const jiraLines = [];

                for (const line of lines) {
                    // ë²ˆí˜¸ ëª©ë¡ ì²˜ë¦¬ (1. 2. 3. ...)
                    const numberedMatch = line.match(/^(\s*)(\d+)\.\s(.+)/);
                    if (numberedMatch) {
                        const indent = numberedMatch[1];
                        const content = numberedMatch[3];
                        const level = Math.floor(indent.length / 2) + 1;
                        jiraLines.push('#'.repeat(level) + ' ' + content);
                        continue;
                    }

                    // ë¶ˆë¦¿ ëª©ë¡ ì²˜ë¦¬ (- * +)
                    const bulletMatch = line.match(/^(\s*)[-*+]\s(.+)/);
                    if (bulletMatch) {
                        const indent = bulletMatch[1];
                        const content = bulletMatch[2];
                        const level = Math.floor(indent.length / 2) + 1;
                        jiraLines.push('*'.repeat(level) + ' ' + content);
                        continue;
                    }

                    // ë¦¬ìŠ¤íŠ¸ê°€ ì•„ë‹Œ ì¤„ì€ ê·¸ëŒ€ë¡œ ìœ ì§€
                    jiraLines.push(line);
                }

                return jiraLines.join('\n');
            }

            // 6. í…ìŠ¤íŠ¸ í¬ë§·íŒ… ë³€í™˜ (ìˆœì„œ ì¤‘ìš”!)
            text = text.replace(/~~(.+?)~~/g, '-$1-');  // ì·¨ì†Œì„ 
            text = markdownListToJira(text);            // ëª©ë¡
            text = text.replace(/\*\*(.+?)\*\*/g, '*$1*');  // êµµì€ ê¸€ì”¨
            // ì´íƒ¤ë¦­ ì²˜ë¦¬ë¥¼ ë” ì•ˆì „í•˜ê²Œ ìˆ˜ì • (í”Œë ˆì´ìŠ¤í™€ë”ë¥¼ í”¼í•˜ë„ë¡)
            text = text.replace(/(?<![@\*])\*([^*\n]+?)\*(?![@\*])/g, '_$1_');  // ê¸°ìš¸ì„
            text = text.replace(/^>\s(.+)/gm, 'bq. $1');  // ì¸ìš©ë¬¸
            
            // 7. ì œëª© ë³€í™˜ (h6ë¶€í„° h1 ìˆœì„œë¡œ - ê¸´ ê²ƒë¶€í„°)
            text = text.replace(/^######\s(.+)/gm, 'h6. $1');
            text = text.replace(/^#####\s(.+)/gm, 'h5. $1');
            text = text.replace(/^####\s(.+)/gm, 'h4. $1');
            text = text.replace(/^###\s(.+)/gm, 'h3. $1');
            text = text.replace(/^##\s(.+)/gm, 'h2. $1');
            text = text.replace(/^#\s(.+)/gm, 'h1. $1');

            // 8. í…Œì´ë¸” ë³€í™˜
            text = text.replace(/^\|.+\|$/gm, function(match, offset, string) {
                // í…Œì´ë¸”ì˜ ì „ì²´ ë¸”ë¡ì„ ì°¾ê¸°
                const lines = string.split('\n');
                const currentLineIndex = string.substring(0, offset).split('\n').length - 1;
                
                // í˜„ì¬ ë¼ì¸ë¶€í„° í…Œì´ë¸” ë¸”ë¡ ì°¾ê¸°
                const tableLines = [];
                let i = currentLineIndex;
                
                // í…Œì´ë¸” ì‹œì‘ì  ì°¾ê¸°
                while (i >= 0 && lines[i].match(/^\|.+\|$/)) {
                    i--;
                }
                i++; // ì²« ë²ˆì§¸ í…Œì´ë¸” ë¼ì¸
                
                // í…Œì´ë¸” ë¼ì¸ë“¤ ìˆ˜ì§‘
                while (i < lines.length && lines[i].match(/^\|.+\|$/)) {
                    const line = lines[i].trim();
                    // êµ¬ë¶„ì„ ì´ ì•„ë‹Œ ê²½ìš°ë§Œ ì¶”ê°€
                    if (!line.match(/^\|[\s\-\|]+\|$/)) {
                        tableLines.push(line);
                    }
                    i++;
                }
                
                if (tableLines.length === 0) return match;
                
                // ì²« ë²ˆì§¸ ë¼ì¸ì¸ ê²½ìš°ì—ë§Œ ì „ì²´ í…Œì´ë¸” ë³€í™˜
                if (currentLineIndex === i - tableLines.length || 
                    !lines[currentLineIndex - 1] || 
                    !lines[currentLineIndex - 1].match(/^\|.+\|$/)) {
                    
                    const jiraTable = [];
                    for (let j = 0; j < tableLines.length; j++) {
                        const line = tableLines[j];
                        const cells = line.slice(1, -1).split('|').map(cell => cell.trim());
                        
                        if (j === 0) { // í—¤ë” í–‰
                            jiraTable.push(`||${cells.join('||')}||`);
                        } else { // ë°ì´í„° í–‰
                            jiraTable.push(`|${cells.join('|')}|`);
                        }
                    }
                    
                    // ë‹¤ë¥¸ í…Œì´ë¸” ë¼ì¸ë“¤ì„ ë¹ˆ ë¬¸ìì—´ë¡œ êµì²´í•˜ê¸° ìœ„í•´ í‘œì‹œ
                    for (let j = 1; j < tableLines.length; j++) {
                        const lineIndex = currentLineIndex + j;
                        if (lineIndex < lines.length) {
                            lines[lineIndex] = '@@TABLE@@PROCESSED@@';
                        }
                    }
                    
                    return jiraTable.join('\n');
                } else if (match === '@@TABLE@@PROCESSED@@') {
                    return '';
                }
                
                return match;
            });

            // 9. ì¸ìš© ë¸”ë¡ ë³€í™˜ (ì—¬ëŸ¬ ì¤„)
            text = text.replace(/(^bq\. .+(\nbq\. .*)*)/gm, function(match) {
                const lines = match.split('\n');
                const quotedLines = lines.map(line => line.replace(/^bq\. /, ''));
                return `{quote}\n${quotedLines.join('\n')}\n{quote}`;
            });

            // 10. í”Œë ˆì´ìŠ¤í™€ë”ë“¤ì„ ì›ë˜ ë‚´ìš©ìœ¼ë¡œ ë³µì›
            // ë§í¬ ë³µì›
            for (let i = 0; i < links.length; i++) {
                text = text.replace(`@@LINK@@${i}@@`, links[i]);
            }

            // ì´ë¯¸ì§€ ë³µì›
            for (let i = 0; i < images.length; i++) {
                text = text.replace(`@@IMAGE@@${i}@@`, images[i]);
            }
            
            // ì¸ë¼ì¸ ì½”ë“œ ë³µì›
            for (let i = 0; i < inlineCodes.length; i++) {
                text = text.replace(`@@INLINE@@CODE@@${i}@@`, inlineCodes[i]);
            }

            // ì½”ë“œ ë¸”ë¡ ë³µì›
            for (let i = 0; i < codeBlocks.length; i++) {
                text = text.replace(`@@CODE@@BLOCK@@${i}@@`, codeBlocks[i]);
            }

            return text;
        }

        // Initialize CodeMirror editors
        function initializeEditors() {
            // Jira editor
            jiraEditor = CodeMirror(document.getElementById('jira-editor'), {
                mode: 'text/plain',
                lineNumbers: true,
                lineWrapping: true,
                viewportMargin: 10,
                scrollbarStyle: "native",
                placeholder: 'Jira ë¬¸ë²•ì„ ì…ë ¥í•˜ì„¸ìš”...',
                theme: 'default'
            });

            // Markdown editor
            markdownEditor = CodeMirror(document.getElementById('markdown-editor'), {
                mode: 'markdown',
                lineNumbers: true,
                lineWrapping: true,
                viewportMargin: 10,
                scrollbarStyle: "native",
                placeholder: 'Markdown ë¬¸ë²•ì„ ì…ë ¥í•˜ì„¸ìš”...',
                theme: 'default'
            });

            // Refresh editors to ensure proper rendering
            setTimeout(() => {
                if (jiraEditor && markdownEditor) {
                    jiraEditor.refresh();
                    markdownEditor.refresh();
                    
                    // ìœˆë„ìš° ë¦¬ì‚¬ì´ì¦ˆ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
                    window.addEventListener('resize', function() {
                        setTimeout(() => {
                            jiraEditor.refresh();
                            markdownEditor.refresh();
                        }, 100);
                    });
                }
            }, 200);

            // Apply initial theme
            applyEditorTheme();
        }

        // Convert Jira to Markdown
        function convertJiraToMarkdown() {
            const jiraText = jiraEditor.getValue().trim();
            if (!jiraText) {
                showStatus('error', 'ë³€í™˜ ì‹¤íŒ¨', 'Jira í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            try {
                const markdownText = jiraToMarkdown(jiraText);
                markdownEditor.setValue(markdownText);
                showStatus('success', 'ë³€í™˜ ì™„ë£Œ', 'Jira ë¬¸ë²•ì´ Markdownìœ¼ë¡œ ì„±ê³µì ìœ¼ë¡œ ë³€í™˜ë˜ì—ˆìŠµë‹ˆë‹¤.');
            } catch (error) {
                showStatus('error', 'ë³€í™˜ ì‹¤íŒ¨', error.message);
            }
        }

        // Convert Markdown to Jira
        function convertMarkdownToJira() {
            const markdownText = markdownEditor.getValue().trim();
            if (!markdownText) {
                showStatus('error', 'ë³€í™˜ ì‹¤íŒ¨', 'Markdown í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            try {
                const jiraText = markdownToJira(markdownText);
                jiraEditor.setValue(jiraText);
                showStatus('success', 'ë³€í™˜ ì™„ë£Œ', 'Markdown ë¬¸ë²•ì´ Jiraë¡œ ì„±ê³µì ìœ¼ë¡œ ë³€í™˜ë˜ì—ˆìŠµë‹ˆë‹¤.');
            } catch (error) {
                showStatus('error', 'ë³€í™˜ ì‹¤íŒ¨', error.message);
            }
        }

        // Sample loading functions
        function loadJiraSample() {
            const sample = `h1. í”„ë¡œì íŠ¸ ê°œìš”

ì´ í”„ë¡œì íŠ¸ëŠ” *ì¤‘ìš”í•œ* ê¸°ëŠ¥ì„ êµ¬í˜„í•©ë‹ˆë‹¤.

h2. ê¸°ëŠ¥ ëª©ë¡

* ì²« ë²ˆì§¸ ê¸°ëŠ¥
** ì„¸ë¶€ ê¸°ëŠ¥ 1
** ì„¸ë¶€ ê¸°ëŠ¥ 2
* ë‘ ë²ˆì§¸ ê¸°ëŠ¥

# ì‘ì—… ìˆœì„œ
## 1ë‹¨ê³„ ì‘ì—…
## 2ë‹¨ê³„ ì‘ì—…

bq. ì´ê²ƒì€ ì¤‘ìš”í•œ ì¸ìš©ë¬¸ì…ë‹ˆë‹¤.

{code:java}
public class Example {
    public static void main(String[] args) {
        System.out.println("Hello World");
    }
}
{code}

||ì œëª©1||ì œëª©2||ì œëª©3||
|ë°ì´í„°1|ë°ì´í„°2|ë°ì´í„°3|
|ë°ì´í„°4|ë°ì´í„°5|ë°ì´í„°6|

[ë§í¬ í…ìŠ¤íŠ¸|https://example.com]

!ì´ë¯¸ì§€íŒŒì¼.png!

{quote}
ì—¬ëŸ¬ ì¤„ì— ê±¸ì¹œ
ì¸ìš©ë¬¸ ì˜ˆì‹œì…ë‹ˆë‹¤.
{quote}`;
            
            jiraEditor.setValue(sample);
            jiraEditor.focus();
        }

        function loadMarkdownSample() {
            const sample = `# í”„ë¡œì íŠ¸ ê°œìš”

ì´ í”„ë¡œì íŠ¸ëŠ” **ì¤‘ìš”í•œ** ê¸°ëŠ¥ì„ êµ¬í˜„í•©ë‹ˆë‹¤.

## ê¸°ëŠ¥ ëª©ë¡

- ì²« ë²ˆì§¸ ê¸°ëŠ¥
  - ì„¸ë¶€ ê¸°ëŠ¥ 1
  - ì„¸ë¶€ ê¸°ëŠ¥ 2
- ë‘ ë²ˆì§¸ ê¸°ëŠ¥

1. 1ë‹¨ê³„ ì‘ì—…
2. 2ë‹¨ê³„ ì‘ì—…

> ì´ê²ƒì€ ì¤‘ìš”í•œ ì¸ìš©ë¬¸ì…ë‹ˆë‹¤.

\`\`\`java
public class Example {
    public static void main(String[] args) {
        System.out.println("Hello World");
    }
}
\`\`\`

| ì œëª©1 | ì œëª©2 | ì œëª©3 |
|-------|-------|-------|
| ë°ì´í„°1 | ë°ì´í„°2 | ë°ì´í„°3 |
| ë°ì´í„°4 | ë°ì´í„°5 | ë°ì´í„°6 |

[ë§í¬ í…ìŠ¤íŠ¸](https://example.com)

![ì´ë¯¸ì§€íŒŒì¼](ì´ë¯¸ì§€íŒŒì¼.png)

> ì—¬ëŸ¬ ì¤„ì— ê±¸ì¹œ
> ì¸ìš©ë¬¸ ì˜ˆì‹œì…ë‹ˆë‹¤.`;
            
            markdownEditor.setValue(sample);
            markdownEditor.focus();
        }

        // Clear functions
        function clearJiraInput() {
            jiraEditor.setValue('');
            jiraEditor.focus();
            hideStatus();
        }

        function clearMarkdownInput() {
            markdownEditor.setValue('');
            markdownEditor.focus();
            hideStatus();
        }

        // Copy functions
        async function copyJiraInput() {
            const text = jiraEditor.getValue();
            if (!text) return;

            try {
                await navigator.clipboard.writeText(text);
                showCopiedBadge('jira-copied-badge');
            } catch (err) {
                alert('ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
        }

        async function copyMarkdownInput() {
            const text = markdownEditor.getValue();
            if (!text) return;

            try {
                await navigator.clipboard.writeText(text);
                showCopiedBadge('markdown-copied-badge');
            } catch (err) {
                alert('ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // Show copied badge
        function showCopiedBadge(badgeId) {
            const badge = document.getElementById(badgeId);
            badge.classList.add('show');
            
            setTimeout(() => {
                badge.classList.remove('show');
            }, 2000);
        }

        // Show status message
        function showStatus(type, title, message) {
            const panel = document.getElementById('status-panel');
            const icon = document.getElementById('status-icon');
            const titleEl = document.getElementById('status-title');
            const messageEl = document.getElementById('status-message');

            panel.className = `status-panel status-${type}`;
            panel.style.display = 'block';
            
            icon.innerHTML = type === 'success' ? 'âœ…' : 'âŒ';
            titleEl.textContent = title;
            messageEl.textContent = message;
        }

        // Hide status panel
        function hideStatus() {
            document.getElementById('status-panel').style.display = 'none';
        }

        // Toggle theme
        function toggleTheme() {
            isDarkMode = !isDarkMode;
            document.body.classList.toggle('dark', isDarkMode);
            document.getElementById('theme-icon').textContent = isDarkMode ? 'â˜€ï¸' : 'ğŸŒ™';
            applyEditorTheme();
        }

        // Apply editor theme
        function applyEditorTheme() {
            const theme = isDarkMode ? 'material-darker' : 'default';
            
            if (jiraEditor) {
                jiraEditor.setOption('theme', theme);
                jiraEditor.refresh();
            }
            if (markdownEditor) {
                markdownEditor.setOption('theme', theme);
                markdownEditor.refresh();
            }
        }

        // Toggle guide content
        function toggleGuideContent(contentId) {
            const content = document.getElementById(contentId + '-content');
            const card = content.closest('.guide-card');
            
            if (content.classList.contains('show')) {
                content.classList.remove('show');
                card.classList.remove('expanded');
            } else {
                // Close all other guide contents first
                document.querySelectorAll('.guide-content.show').forEach(el => {
                    el.classList.remove('show');
                    el.closest('.guide-card').classList.remove('expanded');
                });
                
                // Open current content
                content.classList.add('show');
                card.classList.add('expanded');
            }
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            // Check if CodeMirror is loaded
            if (typeof CodeMirror === 'undefined') {
                alert('Error loading code editor. Please refresh the page.');
                return;
            }
            
            // Initialize editors
            initializeEditors();
            
            // Auto-focus jira editor
            setTimeout(() => {
                if (jiraEditor) {
                    jiraEditor.focus();
                }
            }, 100);
        });
    </script>
</body>
</html>
